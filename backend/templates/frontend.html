<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/app.css') }}">

    <script src="{{ url_for('static', filename='js/jquery-3.5.1.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/socket.io.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plotly-latest.min.js') }}"></script>

    <title>BWCT Video Analysis Tool</title>
</head>

<body>

    <div class="container">
        <h1 class="text-center my-5">BWCT Video Analysis Tool</h1>
        <h2>Upload Video</h2>

        <button id="video-upload-button" class="btn btn-secondary mt-3">Open Video</button>
        <button id="raw-data-button" class="btn btn-secondary mt-3">Import Raw Data</button>

        <div class="progress mt-3">
            <div id="upload-progress" class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0"
                aria-valuemin="0" aria-valuemax="100"></div>
        </div>


        <div id="processing-indicator" style="display: none;">
            <p>Importing video, please wait. This may take several minutes...</p>
        </div>


        <div class="video-container" id="video-container">
            <video id="video-player" controls style="width: 100%; height: 100%;"></video>
            <canvas id="canvas" style="position: absolute; top: 0; left: 0; width: 100%; height: auto;"></canvas>
        </div>


        <div class="form-group">
            <label for="save-video">Save Annotated Video</label>
            <select class="form-control" id="save-video">
                <option value="yes">Yes</option>
                <option value="no">No</option>
            </select>
        </div>

        <div class="button-container">
            <button id="draw-button" class="btn btn-secondary mt-3" style="display: none;">Draw Lines</button>
            <button id="process-button" class="btn btn-secondary mt-3" style="display: none;">Process Video</button>
            <button id="reprocess-button" class="btn btn-secondary mt-3" style="display: none">Reprocess Counts</button>
            <button id="clear-lines-button" class="btn btn-secondary mt-3" style="display: none">Clear Lines</button>

            <button id="download-raw-data-button" class="btn btn-secondary mt-3" style="display: none">Save Raw Data</button>

            <button id="download-lines-button" class="btn btn-secondary mt-3" style="display: none">Save Line
                Crossings</button>


            <button id="download-counts-button" class="btn btn-secondary mt-3" style="display: none">Save Counts
                Output</button>

            <button id="download-processed-video-button" class="btn btn-secondary mt-3" style="display: none">Save
                Processed Video</button>

            <button id="download-plots-button" class="btn btn-secondary mt-3" style="display: none">Save
                Graphs</button>
        </div>

        <h5 id="estimated-time">Estimated time remaining:</h5>
        <div id="processing-loader" class="process_spinner" style="display:none;"></div>

        <div class="progress mt-3">
            <div id="processing-progress" class="progress-bar" role="progressbar" style="width:  0%" aria-valuenow="0"
                aria-valuemin="0" aria-valuemax="100"></div>
        </div>


        <div id="counts-plot"></div>
        <div id="counts-display" style="margin-top:   20px;">
            <table id="counts-table" class="table">
                <thead>
                    <tr>
                        <th>Line</th>
                        <th>Class</th>
                        <th>Direction</th>
                        <th>Count</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Counts data will be inserted here -->
                </tbody>
            </table>
        </div>
        <div id="crossings-plot"></div>

        <div id="person-volume-plot"></div>

        <div id="track-plot"></div>


        <div id="ilovejavascript" style="display: none;">
            <canvas id="thisisfucked"></canvas>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/render_objects.js')}}"></script>
    <script src="{{ url_for('static', filename='js/draw_labels.js')}}"></script>
    <script src="{{ url_for('static', filename='js/save_page_state.js')}}"></script>
    <script src="{{ url_for('static', filename='js/button_handlers.js')}}"></script>
    <script src="{{ url_for('static', filename='js/backend.js')}}"></script>

</body>